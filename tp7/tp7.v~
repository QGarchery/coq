Set Implicit Arguments.


Inductive color : Type :=
| Bl
| Wh.



Definition inv_color (c : color) : color :=
  match c with
  | Wh => Bl
  | Bl => Wh
  end.


Section Triple.

  Variable X : Type.

  Inductive pos : Type := | A | B | C.

  Definition triple : Type := (X * X * X)%type.

  Definition triple_x (x : X) : triple :=
    (x, x, x).

  Definition triple_map (f : X-> X) ( x : triple) : triple :=
    match x with
    | (a, b, c) => (f a, f b, f c)
    end.



  Definition triple_proj (p : pos) (x : triple) : X :=
    match x with
    | (a, b, c) => match p with
                   | A => a
                   | B => b
                   | C => c
                   end
    end.

  Definition triple_map_select (f : X -> X) (p : pos) (x : triple)
    : X :=
    f (triple_proj p x).

End Triple.

Definition board : Type := (triple color * triple color * triple color
                           )%type.


Definition white_board : board :=
  ((Wh, Wh, Wh) ,
   (Wh, Wh, Wh) ,
   (Wh, Wh, Wh) ).

Definition start : board :=
  ((Wh, Wh, Bl),
   (Bl, Wh, Wh),
   (Bl, Bl, Bl)).

Definition target :board :=
  ((Bl, Bl, Bl),
   (Wh, Bl, Wh),
   (Bl, Bl, Wh)).

Check triple_proj.

Definition board_proj (b : board) (pi : pos) (pj : pos) : color :=
  triple_proj pj (triple_proj pi b).

Check pos.

Lemma test1 :
  board_proj start A B = Wh.

Proof.
  unfold board_proj.
  simpl.
  reflexivity.
Qed.

Lemma test2 :
  board_proj start B A = Bl.

Proof.
  unfold board_proj.
  simpl.
  reflexivity.
Qed.

Defini
Definition inv_row (b : board) (p : pos) : board :=
  (triple_map_select (triple_map inv_color) 
                           